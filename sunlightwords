# First, we'll want to load our file of Senate speech words
# These were found at the Sunlight Foundation http://sunlightfoundation.com
 
words = read.csv("http://compute-cuj.org/data2/day3/words.csv",as.is=TRUE)
 
# For starters, lets sum the worr count so we can see who talks the most
num<-words[,4:15]
words$sum<-apply(num, 1, sum)
 
# We want to plot histograms of the different words against each other
# Let's start with the "sum" one histogram
 
hist(words$sum,breaks=50,xlim=c(0,1200))
 
# Let's add a line to that graph
x<-words$sum
h<-hist(x)
xfit<-seq(min(x),max(x),length=40) 
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x)) 
yfit <- yfit*diff(h$mids[1:2])*length(x) 
lines(xfit, yfit, col="blue", lwd=2)
 
# We've got the blue line, but it's not perfect. Let's try a different one
d <- density(x) # returns the density data 
plot(d,col="blue", lwd=2)
polygon(d, col="red", border="blue")

# Let's run a regression on the healthcare and spending, governemnt
summary(words) # give some basic information on the dataset
summary(ols <- lm(health.care ~ spending + government, data = words))
plot(ols, las = 1)


# find relationship between healthcare and spending
summary(hs <- lm(health.care ~ spending, data = words))
plot(hs, las = 1)

# find the top influencers on health care issue
o = order(words$health.care, decreasing=TRUE)[1:10]
hcppl = words[o,] 
hcppl
hcppl$id


install.packages("devtools")
library(devtools)
install_github("govdat", "schamberlain")
library(govdat)
# install rjson and XML
mcc = sll_cw_timeseries("climate change",bioguide_id = "M000303",key="fab63f0586a94bdf8bd042d1db7f8408")
plot(mcc$day,mcc$count)
head(mcc)
?sll_cw_timeseries
# the date field of mcc is a date object. Awesome!!!

# Plot how often they talk about health care
for (i in hcppl$id){
  hcd= sll_cw_timeseries("health care",bioguide_id = i, start_date ="2013-01-01",end_date = "2013-11-01", key="fab63f0586a94bdf8bd042d1db7f8408")
  plot(hcd$day,hcd$count)
}
